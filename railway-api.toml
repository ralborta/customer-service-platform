# Railway config for API service
# Use this when deploying the API service

[build]
builder = "NIXPACKS"
buildCommand = "pnpm install --frozen-lockfile && rm -rf node_modules/.cache packages/shared/dist packages/db/dist apps/api/dist && pnpm --filter @customer-service/shared build && pnpm --filter @customer-service/db build && pnpm --filter @customer-service/api build"

[deploy]
# Inicializar DB antes de iniciar el servidor
startCommand = "bash scripts/init-db-railway.sh && node apps/api/dist/index.js"
healthcheckPath = "/health"
healthcheckTimeout = 100
